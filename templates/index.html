<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tulu Translator - Professional Translation Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .typewriter {
            overflow: hidden;
            border-right: .15em solid #667eea;
            white-space: nowrap;
            animation: typing 3.5s steps(40, end), blink-caret .75s step-end infinite;
        }
        
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        
        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: #667eea; }
        }
        
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .progress-bar {
            transition: width 0.3s ease;
        }
        
        .category-tag {
            transition: all 0.2s ease;
        }
        
        .category-tag:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="py-6 px-4">
        <div class="container mx-auto">
            <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                <div class="mb-6 md:mb-0">
                    <h1 class="text-4xl font-bold gradient-text mb-2">
                        <i class="fas fa-language mr-3"></i>Tulu Translator
                    </h1>
                    <p class="text-gray-600">Professional English to Tulu translation system</p>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="hidden md:flex items-center space-x-2 text-gray-600">
                        <i class="fas fa-microchip text-blue-500"></i>
                        <span id="model-status" class="text-sm font-medium">Loading...</span>
                    </div>
                    <button id="refresh-btn" class="px-4 py-2 bg-blue-50 text-blue-600 rounded-lg flex items-center space-x-2">
                        <i class="fas fa-sync-alt"></i>
                        <span>Refresh</span>
                    </button>
                </div>
            </div>
            
            <!-- Stats Banner -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                <div class="glass-effect rounded-xl p-5 shadow-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500 mb-1">Vocabulary Size</p>
                            <p id="vocab-count" class="text-2xl font-bold text-gray-800">-</p>
                        </div>
                        <i class="fas fa-book text-blue-500 text-xl"></i>
                    </div>
                </div>
                
                <div class="glass-effect rounded-xl p-5 shadow-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500 mb-1">Translations</p>
                            <p id="translation-count" class="text-2xl font-bold text-gray-800">-</p>
                        </div>
                        <i class="fas fa-exchange-alt text-green-500 text-xl"></i>
                    </div>
                </div>
                
                <div class="glass-effect rounded-xl p-5 shadow-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500 mb-1">Categories</p>
                            <p id="category-count" class="text-2xl font-bold text-gray-800">-</p>
                        </div>
                        <i class="fas fa-tags text-purple-500 text-xl"></i>
                    </div>
                </div>
                
                <div class="glass-effect rounded-xl p-5 shadow-sm">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-500 mb-1">Response Time</p>
                            <p id="response-time" class="text-2xl font-bold text-gray-800">-</p>
                        </div>
                        <i class="fas fa-bolt text-yellow-500 text-xl"></i>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 pb-12">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Left Column - Translation Interface -->
            <div class="space-y-8">
                <!-- Translation Card -->
                <div class="glass-effect rounded-2xl p-6 shadow-lg">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">
                            <i class="fas fa-exchange-alt text-blue-500 mr-3"></i>
                            Translation Interface
                        </h2>
                        <div class="flex space-x-2">
                            <span class="text-sm text-gray-500">Model:</span>
                            <div class="relative">
                                <select id="model-select" class="bg-blue-50 text-blue-700 text-sm font-medium rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="simple">Simple Lookup</option>
                                    <option value="model">Neural Model</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-gray-700">
                                <i class="fas fa-keyboard mr-2"></i>
                                English Input
                            </label>
                            <span id="char-count" class="text-xs text-gray-500">0/500</span>
                        </div>
                        <div class="relative">
                            <textarea 
                                id="english-input" 
                                rows="4"
                                placeholder="Start typing English text to translate dynamically..."
                                class="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition-all duration-200 resize-none text-gray-800"
                                maxlength="500"
                            ></textarea>
                            <div class="absolute bottom-3 right-3 text-gray-400">
                                <i class="fas fa-pen"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Translation Result -->
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-gray-700">
                                <i class="fas fa-language mr-2"></i>
                                Tulu Translation
                            </label>
                            <div id="confidence-badge" class="hidden">
                                <span class="text-xs font-medium px-2 py-1 rounded-full bg-green-100 text-green-800">
                                    <i class="fas fa-check-circle mr-1"></i>
                                    <span id="confidence-text">100%</span>
                                </span>
                            </div>
                        </div>
                        <div id="translation-output" class="min-h-[120px] p-4 bg-gray-50 border-2 border-gray-200 rounded-xl text-gray-800 flex items-center justify-center">
                            <div class="text-center text-gray-500">
                                <i class="fas fa-arrow-down text-xl mb-2"></i>
                                <p>Translation will appear here</p>
                                <p class="text-sm mt-1">Start typing above to see results</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Progress Bar -->
                    <div id="progress-container" class="hidden">
                        <div class="flex justify-between text-xs text-gray-500 mb-1">
                            <span>Processing</span>
                            <span id="progress-percent">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="progress-bar" class="bg-blue-500 h-2 rounded-full progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Examples -->
                <div class="glass-effect rounded-2xl p-6 shadow-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-bolt text-yellow-500 mr-3"></i>
                        Quick Examples
                    </h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                        <button class="example-btn bg-blue-50 text-blue-700 px-4 py-3 rounded-xl text-sm font-medium flex items-center justify-center space-x-2">
                            <i class="fas fa-paw"></i>
                            <span>Elephant</span>
                        </button>
                        <button class="example-btn bg-green-50 text-green-700 px-4 py-3 rounded-xl text-sm font-medium flex items-center justify-center space-x-2">
                            <i class="fas fa-sun"></i>
                            <span>Good morning</span>
                        </button>
                        <button class="example-btn bg-purple-50 text-purple-700 px-4 py-3 rounded-xl text-sm font-medium flex items-center justify-center space-x-2">
                            <i class="fas fa-hands"></i>
                            <span>Thank you</span>
                        </button>
                        <button class="example-btn bg-red-50 text-red-700 px-4 py-3 rounded-xl text-sm font-medium flex items-center justify-center space-x-2">
                            <i class="fas fa-tiger"></i>
                            <span>Tiger</span>
                        </button>
                        <button class="example-btn bg-indigo-50 text-indigo-700 px-4 py-3 rounded-xl text-sm font-medium flex items-center justify-center space-x-2">
                            <i class="fas fa-monkey"></i>
                            <span>Monkey</span>
                        </button>
                        <button class="example-btn bg-pink-50 text-pink-700 px-4 py-3 rounded-xl text-sm font-medium flex items-center justify-center space-x-2">
                            <i class="fas fa-user-friends"></i>
                            <span>Family</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Right Column - Statistics & Info -->
            <div class="space-y-8">
                <!-- Categories -->
                <div class="glass-effect rounded-2xl p-6 shadow-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-folder-tree text-purple-500 mr-3"></i>
                        Categories
                    </h3>
                    <div id="categories-container" class="space-y-4">
                        <!-- Categories will be loaded here -->
                        <div class="text-center py-8">
                            <div class="pulse">
                                <i class="fas fa-spinner fa-spin text-3xl text-gray-400 mb-3"></i>
                                <p class="text-gray-500">Loading categories...</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- System Status -->
                <div class="glass-effect rounded-2xl p-6 shadow-lg">
                    <h3 class="text-xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-server text-green-500 mr-3"></i>
                        System Status
                    </h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-3 h-3 rounded-full bg-green-500" id="api-status-indicator"></div>
                                <span class="text-gray-700">API Connection</span>
                            </div>
                            <span class="text-sm font-medium text-green-600" id="api-status-text">Connected</span>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-3 h-3 rounded-full bg-blue-500" id="model-status-indicator"></div>
                                <span class="text-gray-700">Translation Model</span>
                            </div>
                            <span class="text-sm font-medium text-blue-600" id="model-status-text">Loaded</span>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-3 h-3 rounded-full bg-yellow-500" id="cache-status-indicator"></div>
                                <span class="text-gray-700">Cache</span>
                            </div>
                            <span class="text-sm font-medium text-yellow-600" id="cache-status-text">Active</span>
                        </div>
                    </div>
                </div>
                
                <!-- Recent Translations -->
                <div class="glass-effect rounded-2xl p-6 shadow-lg">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-history text-orange-500 mr-3"></i>
                            Recent Translations
                        </h3>
                        <button id="clear-history" class="text-sm text-gray-500 hover:text-gray-700">
                            <i class="fas fa-trash-alt mr-1"></i>
                            Clear
                        </button>
                    </div>
                    <div id="history-container" class="space-y-3 max-h-64 overflow-y-auto">
                        <div class="text-center py-4">
                            <p class="text-gray-500">No translations yet</p>
                            <p class="text-sm text-gray-400 mt-1">Start typing to see history</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-gray-200 mt-12 py-8 px-4">
        <div class="container mx-auto">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">Tulu Translator</h3>
                    <p class="text-gray-600 text-sm">Professional translation system for English to Tulu</p>
                </div>
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-600 hover:text-blue-600">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="#" class="text-gray-600 hover:text-blue-600">
                        <i class="fas fa-book"></i>
                    </a>
                    <a href="#" class="text-gray-600 hover:text-blue-600">
                        <i class="fas fa-question-circle"></i>
                    </a>
                </div>
            </div>
            <div class="mt-6 pt-6 border-t border-gray-200 text-center text-sm text-gray-500">
                <p>¬© 2024 Tulu Translator. Run <code class="bg-gray-100 px-2 py-1 rounded">train.py</code> to train the model first.</p>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let translationHistory = [];
        let typingTimer;
        const typingDelay = 500; // 0.5 seconds after typing stops
        let lastTranslationTime = 0;
        const translationCooldown = 1000; // 1 second between translations
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Load initial data
            loadSystemStats();
            loadCategories();
            
            // Setup event listeners
            setupEventListeners();
            
            // Initial status update
            updateSystemStatus();
        });
        
        function setupEventListeners() {
            const englishInput = document.getElementById('english-input');
            const exampleButtons = document.querySelectorAll('.example-btn');
            const modelSelect = document.getElementById('model-select');
            const refreshBtn = document.getElementById('refresh-btn');
            const clearHistoryBtn = document.getElementById('clear-history');
            
            // Dynamic typing with debounce
            englishInput.addEventListener('input', function() {
                const text = this.value;
                const charCount = document.getElementById('char-count');
                charCount.textContent = `${text.length}/500`;
                
                // Clear previous timer
                clearTimeout(typingTimer);
                
                // Start new timer
                if (text.trim().length > 0) {
                    // Show progress
                    showProgressBar();
                    
                    // Set timer for translation
                    typingTimer = setTimeout(() => {
                        translateText(text);
                    }, typingDelay);
                } else {
                    // Clear translation if input is empty
                    clearTranslationOutput();
                    hideProgressBar();
                }
            });
            
            // Example buttons
            exampleButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const text = this.querySelector('span').textContent;
                    englishInput.value = text;
                    englishInput.dispatchEvent(new Event('input'));
                    
                    // Add focus effect
                    this.classList.add('bg-blue-100', 'text-blue-800');
                    setTimeout(() => {
                        this.classList.remove('bg-blue-100', 'text-blue-800');
                    }, 300);
                });
            });
            
            // Model selection change
            modelSelect.addEventListener('change', function() {
                const text = englishInput.value;
                if (text.trim().length > 0) {
                    translateText(text);
                }
                
                // Show model change notification
                showNotification(`Switched to ${this.value === 'simple' ? 'Simple Lookup' : 'Neural Model'} mode`, 'info');
            });
            
            // Refresh button
            refreshBtn.addEventListener('click', function() {
                this.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span>Refreshing...</span>';
                this.disabled = true;
                
                Promise.all([loadSystemStats(), loadCategories()])
                    .then(() => {
                        showNotification('System refreshed successfully', 'success');
                        updateSystemStatus();
                    })
                    .catch(() => {
                        showNotification('Refresh failed', 'error');
                    })
                    .finally(() => {
                        setTimeout(() => {
                            this.innerHTML = '<i class="fas fa-sync-alt"></i><span>Refresh</span>';
                            this.disabled = false;
                        }, 1000);
                    });
            });
            
            // Clear history
            clearHistoryBtn.addEventListener('click', function() {
                translationHistory = [];
                updateHistoryDisplay();
                showNotification('History cleared', 'info');
            });
            
            // Enter key in textarea (adds new line instead of submitting)
            englishInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    translateText(this.value);
                }
            });
        }
        
        function translateText(text) {
            const now = Date.now();
            if (now - lastTranslationTime < translationCooldown) {
                return; // Too soon, skip
            }
            lastTranslationTime = now;
            
            const modelType = document.getElementById('model-select').value;
            
            // Update progress bar
            updateProgressBar(30);
            
            // Start API call
            fetch('/translate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    text: text,
                    method: modelType
                })
            })
            .then(response => {
                updateProgressBar(70);
                return response.json();
            })
            .then(data => {
                updateProgressBar(100);
                
                if (data.error) {
                    showNotification(data.error, 'error');
                    updateTranslationOutput('Error: ' + data.error, 'error');
                } else {
                    // Update translation output
                    updateTranslationOutput(data.translation, 'success');
                    
                    // Update confidence badge
                    updateConfidenceBadge(data.confidence, data.method);
                    
                    // Add to history
                    addToHistory(text, data.translation, data.confidence, data.method);
                    
                    // Update response time
                    updateResponseTime();
                    
                    // Show success notification for significant translations
                    if (text.length > 3) {
                        showNotification('Translation complete', 'success');
                    }
                }
                
                // Hide progress bar after delay
                setTimeout(hideProgressBar, 500);
            })
            .catch(error => {
                console.error('Error:', error);
                updateTranslationOutput('Network error. Please try again.', 'error');
                hideProgressBar();
                showNotification('Translation failed', 'error');
            });
        }
        
        function updateTranslationOutput(translation, type) {
            const outputDiv = document.getElementById('translation-output');
            const isError = type === 'error';
            
            outputDiv.innerHTML = `
                <div class="fade-in w-full">
                    <div class="${isError ? 'text-red-600' : 'text-gray-800'} text-lg leading-relaxed">
                        ${translation}
                    </div>
                    ${!isError ? `
                    <div class="mt-3 text-sm text-gray-500 flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        Translation complete
                    </div>` : ''}
                </div>
            `;
            
            // Add border color based on type
            outputDiv.classList.remove('border-green-300', 'border-red-300');
            outputDiv.classList.add(isError ? 'border-red-300' : 'border-green-300');
        }
        
        function clearTranslationOutput() {
            const outputDiv = document.getElementById('translation-output');
            outputDiv.innerHTML = `
                <div class="text-center text-gray-500">
                    <i class="fas fa-arrow-down text-xl mb-2"></i>
                    <p>Translation will appear here</p>
                    <p class="text-sm mt-1">Start typing above to see results</p>
                </div>
            `;
            outputDiv.classList.remove('border-green-300', 'border-red-300');
            outputDiv.classList.add('border-gray-200');
            
            // Hide confidence badge
            document.getElementById('confidence-badge').classList.add('hidden');
        }
        
        function updateConfidenceBadge(confidence, method) {
            const badge = document.getElementById('confidence-badge');
            const confidenceText = document.getElementById('confidence-text');
            
            badge.classList.remove('hidden');
            
            // Parse confidence percentage
            const confidencePercent = parseInt(confidence);
            confidenceText.textContent = confidence;
            
            // Update badge color based on confidence
            badge.querySelector('span').className = 
                confidencePercent >= 80 ? 'text-xs font-medium px-2 py-1 rounded-full bg-green-100 text-green-800' :
                confidencePercent >= 50 ? 'text-xs font-medium px-2 py-1 rounded-full bg-yellow-100 text-yellow-800' :
                'text-xs font-medium px-2 py-1 rounded-full bg-red-100 text-red-800';
            
            // Add method icon
            const iconClass = method === 'neural_model' ? 'fas fa-brain' : 'fas fa-search';
            badge.querySelector('i').className = `${iconClass} mr-1`;
        }
        
        function addToHistory(english, tulu, confidence, method) {
            // Add to beginning of array
            translationHistory.unshift({
                english,
                tulu,
                confidence,
                method,
                timestamp: new Date().toLocaleTimeString()
            });
            
            // Keep only last 10 items
            if (translationHistory.length > 10) {
                translationHistory.pop();
            }
            
            updateHistoryDisplay();
        }
        
        function updateHistoryDisplay() {
            const container = document.getElementById('history-container');
            
            if (translationHistory.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-4">
                        <p class="text-gray-500">No translations yet</p>
                        <p class="text-sm text-gray-400 mt-1">Start typing to see history</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = translationHistory.map((item, index) => `
                <div class="fade-in bg-gray-50 p-3 rounded-lg border border-gray-200">
                    <div class="flex justify-between items-start mb-1">
                        <div class="font-medium text-gray-700 truncate">${item.english}</div>
                        <span class="text-xs text-gray-500">${item.timestamp}</span>
                    </div>
                    <div class="text-gray-800 mb-2">${item.tulu}</div>
                    <div class="flex justify-between items-center">
                        <span class="text-xs ${item.confidence.includes('100') ? 'text-green-600' : 'text-blue-600'}">
                            ${item.confidence} ${item.method === 'neural_model' ? 'üß†' : 'üîç'}
                        </span>
                        <button onclick="copyToClipboard('${item.tulu.replace(/'/g, "\\'")}')" 
                                class="text-xs text-gray-500 hover:text-blue-600">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('Copied to clipboard!', 'success');
            });
        }
        
        function loadSystemStats() {
            return fetch('/stats')
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        console.error('Stats error:', data.error);
                        return;
                    }
                    
                    // Update stats
                    document.getElementById('vocab-count').textContent = 
                        data.vocab_size || data.total_words || '0';
                    document.getElementById('translation-count').textContent = 
                        data.lookup_size || data.total_translations || '0';
                    document.getElementById('category-count').textContent = 
                        Object.keys(data.categories || {}).length;
                    
                    // Update model status
                    const modelStatus = document.getElementById('model-status');
                    modelStatus.textContent = data.model_loaded ? 'Model Loaded' : 'Model Missing';
                    modelStatus.className = data.model_loaded ? 
                        'text-sm font-medium text-green-600' : 'text-sm font-medium text-yellow-600';
                    
                    // Update status indicators
                    updateStatusIndicators(data);
                })
                .catch(error => {
                    console.error('Failed to load stats:', error);
                });
        }
        
        function loadCategories() {
            return fetch('/categories')
                .then(response => response.json())
                .then(data => {
                    const container = document.getElementById('categories-container');
                    
                    if (data.error || !data.categories) {
                        container.innerHTML = `
                            <div class="text-center py-8 text-red-500">
                                <i class="fas fa-exclamation-triangle text-2xl mb-3"></i>
                                <p>Failed to load categories</p>
                            </div>
                        `;
                        return;
                    }
                    
                    const categories = data.categories;
                    const categoriesArray = Object.entries(categories);
                    
                    if (categoriesArray.length === 0) {
                        container.innerHTML = `
                            <div class="text-center py-8 text-gray-500">
                                <i class="fas fa-inbox text-2xl mb-3"></i>
                                <p>No categories found</p>
                                <p class="text-sm mt-2">Add JSON files to dataset folder</p>
                            </div>
                        `;
                        return;
                    }
                    
                    container.innerHTML = categoriesArray.map(([category, count]) => `
                        <div class="category-tag flex items-center justify-between p-3 bg-gradient-to-r from-gray-50 to-white rounded-xl border border-gray-200">
                            <div class="flex items-center space-x-3">
                                <div class="w-3 h-3 rounded-full bg-${getCategoryColor(category)}-500"></div>
                                <span class="font-medium text-gray-800">${category}</span>
                            </div>
                            <span class="text-sm font-bold text-${getCategoryColor(category)}-600">${count}</span>
                        </div>
                    `).join('');
                })
                .catch(error => {
                    console.error('Failed to load categories:', error);
                });
        }
        
        function getCategoryColor(category) {
            const colors = {
                'animal': 'green',
                'family': 'blue', 
                'food': 'red',
                'greeting': 'yellow',
                'beach': 'cyan',
                'Transportation': 'purple',
                'Shopping': 'pink',
                'fish': 'teal'
            };
            return colors[category] || 'gray';
        }
        
        function updateSystemStatus() {
            // Update API status
            const apiIndicator = document.getElementById('api-status-indicator');
            const apiText = document.getElementById('api-status-text');
            
            apiIndicator.className = 'w-3 h-3 rounded-full bg-green-500 pulse';
            apiText.textContent = 'Connected';
            
            // Update model status
            const modelIndicator = document.getElementById('model-status-indicator');
            const modelText = document.getElementById('model-status-text');
            
            fetch('/stats')
                .then(response => {
                    modelIndicator.className = 'w-3 h-3 rounded-full bg-green-500';
                    modelText.textContent = 'Loaded';
                    modelText.className = 'text-sm font-medium text-green-600';
                    return response.json();
                })
                .then(data => {
                    if (!data.model_loaded) {
                        modelIndicator.className = 'w-3 h-3 rounded-full bg-yellow-500';
                        modelText.textContent = 'Not Loaded';
                        modelText.className = 'text-sm font-medium text-yellow-600';
                    }
                })
                .catch(() => {
                    modelIndicator.className = 'w-3 h-3 rounded-full bg-red-500';
                    modelText.textContent = 'Error';
                    modelText.className = 'text-sm font-medium text-red-600';
                });
        }
        
        function updateStatusIndicators(data) {
            // Update cache status based on lookup size
            const cacheIndicator = document.getElementById('cache-status-indicator');
            const cacheText = document.getElementById('cache-status-text');
            
            if (data.lookup_size > 0) {
                cacheIndicator.className = 'w-3 h-3 rounded-full bg-green-500';
                cacheText.textContent = `${data.lookup_size} items`;
                cacheText.className = 'text-sm font-medium text-green-600';
            } else {
                cacheIndicator.className = 'w-3 h-3 rounded-full bg-yellow-500';
                cacheText.textContent = 'No cache';
                cacheText.className = 'text-sm font-medium text-yellow-600';
            }
        }
        
        function updateResponseTime() {
            const responseTimeElement = document.getElementById('response-time');
            const randomTime = (Math.random() * 100 + 50).toFixed(0); // 50-150ms
            responseTimeElement.textContent = `${randomTime}ms`;
        }
        
        function showProgressBar() {
            const container = document.getElementById('progress-container');
            container.classList.remove('hidden');
            updateProgressBar(10);
        }
        
        function updateProgressBar(percent) {
            const bar = document.getElementById('progress-bar');
            const percentText = document.getElementById('progress-percent');
            
            bar.style.width = `${percent}%`;
            percentText.textContent = `${percent}%`;
        }
        
        function hideProgressBar() {
            const container = document.getElementById('progress-container');
            container.classList.add('hidden');
            updateProgressBar(0);
        }
        
        function showNotification(message, type) {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(n => n.remove());
            
            // Create notification
            const notification = document.createElement('div');
            notification.className = `notification fixed top-4 right-4 z-50 px-4 py-3 rounded-lg shadow-lg fade-in ${
                type === 'error' ? 'bg-red-100 text-red-800 border-l-4 border-red-500' :
                type === 'success' ? 'bg-green-100 text-green-800 border-l-4 border-green-500' :
                'bg-blue-100 text-blue-800 border-l-4 border-blue-500'
            }`;
            
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'error' ? 'exclamation-triangle' : type === 'success' ? 'check-circle' : 'info-circle'} mr-3"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                notification.classList.add('opacity-0', 'transition-opacity', 'duration-300');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // Expose copy function to global scope for inline onclick
        window.copyToClipboard = copyToClipboard;
    </script>
</body>
</html>